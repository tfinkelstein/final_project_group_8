# FIRST PAGE

---
title: "Suicide Rates in the United States (2014-2017)"
author: "Naomi Giancola, Christina Sherpa, Tessa Finkelstein"
date: "Last updated on `r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    df_print: kable
---

<!-- 
Comments in HTML are like this! 
-->

# Suicide Deaths per 100,000 People

Write an intro `index.html` page in blog-post style that summarizes your work. It should have

1. One visualization that best summarizes your work.
1. No more than 200 words of text

```{r, echo = FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(readr)
library(leaflet)

MH_12 <- read_csv("MH_12.csv")

Suicide_Mortality_by_State <- read_csv("Suicide Mortality by State.csv")

region <- read_csv("region.csv")

kaggle_income <- read_csv("kaggle_income.csv")

statelatlong_1_ <- read_csv("statelatlong (1).csv")
```

```{r, echo=FALSE}
not_2005 <- Suicide_Mortality_by_State %>% 
  filter(YEAR!= "2005")

region_suicide <- region %>% 
  rename(STATE= "State Code") %>% 
  full_join(Suicide_Mortality_by_State, by="STATE") %>% 
  filter(YEAR!= "2005")

ggplot(data=not_2005, mapping=aes(group= YEAR, x=YEAR, y=RATE))+
  geom_boxplot()+
  labs(x= "Year", y= "Rate", title= "Suicide Deaths per 100,000 People in the United States by Year")+
  scale_x_continuous( breaks=seq(2014,2017,1))+
  theme_dark()
  ```
  
# SECOND PAGE

---
title: "More information"
author: "Naomi Giancola, Christina Sherpa, Tessa Finkelstein"
date: "Last updated on `r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    df_print: kable
---

<!--
Comments in HTML are like this! 
-->

# Suicide by Region in the United States

Write a second `more_info.html` page going more in-depth for people who want more details. In should have

1. Between 2-3 more visualizations.
1. No more than 500 words of text

```{r, echo = FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(readr)
library(leaflet)
MH_12 <- read_csv("MH_12.csv")

Suicide_Mortality_by_State <- read_csv("Suicide Mortality by State.csv")

region <- read_csv("region.csv")

kaggle_income <- read_csv("kaggle_income.csv")

statelatlong_1_ <- read_csv("statelatlong (1).csv")
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
not_2005 <- Suicide_Mortality_by_State %>% 
  filter(YEAR!= "2005")

region_suicide <- region %>% 
  rename(STATE= "State Code") %>% 
  full_join(Suicide_Mortality_by_State, by="STATE") %>% 
  filter(YEAR!= "2005")
```
```{r, echo=FALSE, warning=FALSE, message=FALSE}
ggplot(data=region_suicide, mapping=aes(x=YEAR, y=RATE, group= YEAR))+
  geom_boxplot()+
  scale_x_continuous( breaks=seq(2014,2017,1))+
  facet_wrap(~Region)+
  labs(x= "Year", y= "Rate", title= "Suicide Deaths per 100,000 People by Region")+
  theme_dark()

ggplot(data=region_suicide, mapping=aes(x=YEAR, y=RATE, fill=Division))+
  geom_col(position = "dodge")+
  labs(x= "Year", y= "Rate", title= "Suicide Deaths per 100,000 People by Division")+
  scale_fill_manual(values = c("#fff7fb", "#ece7f2", "#d0d1e6", "#a6bddb", "#74a9cf", "#3690c0", "#0570b0", "#045a8d", "#023858"))+
  theme_dark()
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
ggplot(data = region_suicide, mapping = aes(x = RATE, y = DEATHS)) +
  geom_point(aes(color = Region))
```

# EXTRA STUFF
 
 # top/bottom 5 states with high/low rates
region_suicide_top5_bottom5 <- region_suicide %>%
  filter(STATE %in% c("ID","NM","WY","AK","MT","NY","NJ","MA","MD","CA","CT"))

# top 2017
region_suicide_top5_2017 <- region_suicide %>%
  filter(YEAR == "2017") %>%
  arrange(RATE) %>%
  top_n(5, RATE)
# bottom 2017
region_suicide_bottom5_2017 <- region_suicide %>%
  filter(YEAR == "2017") %>%
  arrange(RATE) %>%
  top_n(-5, RATE)

# Tessa makes some graphs

ggplot(data = region_suicide, mapping = aes(x = RATE, y = DEATHS)) +
  geom_point(aes(color = Region)) +
  facet_wrap(~YEAR) +
  labs(x= "Rate", y= "Year", title= "Suicide Attempt Rates vs. Actual Deaths (by Region)") +
  scale_color_manual(values = c("#f1eef6", "#bdc9e1", "#74a9cf", "#0570b0")) +
  theme_dark()
 
 EVERYTHING BELOW IS CHRISTINA'S MAP DATA (INCOME)
 
 #wrangling income
income<-kaggle_income %>% 
  select(Median,State_Name) %>% 
  filter(!State_Name == "Puerto Rico", !State_Name == "District of Columbia") %>% 
  group_by(State_Name) %>%  
  summarize(median_income = median(Median))

View(income)
 #wrangling location
location <-statelatlong_1_ %>% 
  filter(!City == "Puerto Rico", !City == "District of Columbia") 

View(location)

#combining location and income
income_location <- income %>% 
  full_join(location, by = c("State_Name" = "City" )) 

View(income_location)

#experimenting with maps
leaflet(data = income_location) %>%
  addTiles() %>% 
  # We need to map the lng, lat variables in clinton_stops_df
  addMarkers(lng = ~Longitude, lat = ~Latitude)

#filter suicide to only have data from 2017 
suicide_2017<-Suicide %>% 
  filter(YEAR == "2017") %>% 
 
View(suicide_2017)


#combining Suicide w/ income and location
suicide_income_location<-income_location %>% 
  full_join(suicide_2017, by= c("State" = "STATE")) %>% 
  mutate(State_Name = toupper(State_Name))

View(suicide_income_location)


# Load maps package map object of US states and plot using default R plot
# function (not ggplot2). Plot is not pretty!
USA_map <-  maps::map("state", plot = FALSE, fill = TRUE)
plot(USA_map)

# Convert maps package map object to sf object using st_as_sf() again:
USA_sf <- USA_map %>% 
  sf::st_as_sf(crs = 4326) %>% 
  filter(!ID == "district of columbia") %>% 
  mutate(ID = toupper(ID))
  
#join usa_sf with suicide_income-location to get geom for map 
map_data<-suicide_income_location %>% 
  full_join(USA_sf, by = c("State_Name" = "ID"))
  
View(map_data)

```
