---
title: "My Final Project"
author: "Guy Incognito"
date: "Last updated on `r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    df_print: kable
---

<!-- 
Comments in HTML are like this! 
-->

# SECTION NAME

## Subsection name

Write an intro `index.html` page in blog-post style that summarizes your work. It should have

1. One visualization that best summarizes your work.
1. No more than 200 words of text

```{r, echo = FALSE}
library(tidyverse)
library(readr)
library(leaflet)

Suicide_Mortality_by_State <- read_csv("Suicide Mortality by State.csv")

region <- read_csv("region.csv")

region_suicide <- region %>% 
  rename(STATE= "State Code") %>% 
  full_join(Suicide_Mortality_by_State, by="STATE") %>% 
  filter(YEAR!= "2005")

ggplot(data=not_2005, mapping=aes(group= YEAR, x=YEAR, y=RATE))+
  geom_boxplot()+
  labs(x= "Year", y= "Rate", title= "Suicide Deaths per 100,000 People")+
  scale_x_continuous( breaks=seq(2014,2017,1))

ggplot(data=region_suicide, mapping=aes(x=YEAR, y=RATE, group= YEAR, fill=Region))+
  geom_boxplot()+
  scale_x_continuous( breaks=seq(2014,2017,1))+
  facet_wrap(~Region)+
  labs(x= "Year", y= "Rate", title= "Suicide Deaths per 100,000 People Split by Region")

ggplot(data=region_suicide, mapping=aes(x=YEAR, y=RATE, fill=Division))+
  geom_col(position = "dodge")+
  labs(x= "Year", y= "Rate", title= "Suicide Deaths per 100,000 People Split by Division")
  
  
 #wrangling income
income<-kaggle_income %>% 
  select(Median,State_Name) %>% 
  filter(!State_Name == "Puerto Rico", !State_Name == "District of Columbia") %>% 
  group_by(State_Name) %>%  
  summarize(median_income = median(Median))

View(income)
 #wrangling location
location <-statelatlong_1_ %>% 
  filter(!City == "Puerto Rico", !City == "District of Columbia") 

View(location)

#combining location and income
income_location <- income %>% 
  full_join(location, by = c("State_Name" = "City" )) 

View(income_location)

#experimenting with maps
leaflet(data = income_location) %>%
  addTiles() %>% 
  # We need to map the lng, lat variables in clinton_stops_df
  addMarkers(lng = ~Longitude, lat = ~Latitude)

#filter suicide to only have data from 2017 
suicide_2017<-Suicide %>% 
  filter(YEAR == "2017") %>% 
 
View(suicide_2017)


#combining Suicide w/ income and location
suicide_income_location<-income_location %>% 
  full_join(suicide_2017, by= c("State" = "STATE")) %>% 
  mutate(State_Name = toupper(State_Name))

View(suicide_income_location)


# Load maps package map object of US states and plot using default R plot
# function (not ggplot2). Plot is not pretty!
USA_map <-  maps::map("state", plot = FALSE, fill = TRUE)
plot(USA_map)

# Convert maps package map object to sf object using st_as_sf() again:
USA_sf <- USA_map %>% 
  sf::st_as_sf(crs = 4326) %>% 
  filter(!ID == "district of columbia") %>% 
  mutate(ID = toupper(ID))
  
#join usa_sf with suicide_income-location to get geom for map 
map_data<-suicide_income_location %>% 
  full_join(USA_sf, by = c("State_Name" = "ID"))
  
View(map_data)

```
